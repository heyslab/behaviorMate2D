// C++ style '//' comments are permitted to comment out the end of lines
// but block style i.e. '/*' will not work
{
    "_controllers": {
        "behavior_controller": { // address behavior arduino is posting message
            "ip": "127.0.0.1",   // to
            "send_port": 5010,
            "receive_port": 5015
        },
        "position_controller": { // address arduino reading rotary encoder is
            "ip": "127.0.0.1",   // posting messages to
            "send_port": 5020,
            "receive_port": 5025
        },
    },
    "example": { // name for each profile of in this setting file
        "uses": "_controllers",
        "reward": {
            "locations": [ // centroid of reward locations (for fixed rewards).
                500,       // if integer rewards instead of list, that many rewards
                1000,      // will be placed randomly and shuffled each lap.
                1500,
                5000
            ],
            "radius": 200, // radius (in mm) of the reward zones
            "max_duration": 5, // maximum time the reward zone context is
                               // allowed to be on (even if animal is
                               // stationary)
            "type": "fixed", // moving or fixed. fixed requires a list of
                             // loctions moving requires "number" to be set
            "drop_size": 60, // time (in ms) duration for the reward water valve
                             // to be open
            "pin": 7,        // ardunio pin that the water reward solinoid is
                             // connected to
            "operant_rate": 2, // issue additional rewards for this number of
                               // licks
            "initial_open": 0 // 0 or 1 if set to 1 a non-operant reward is
                              // issued when the reward zone is first entered
        },
        // "sensors" is a list of all the sensors that need to be configured on
        // the behavior arduino. See sensor manager class in behavior
        // controller. Default sensor type is to read a ttl pulse/square wave
        // input. a lickport type context  is necessary for rewarding contexts.
        "sensors": [
            {
                "type": "lickport", // "lickport" type sensor is based on the
                                    // MPR121 capacitance touch sensor.
                "pin": 2,           // Interrupt/IRQ pin
                "report_pin": 20    // sets up a ttl pulse to report when the
                                    // sensor is triggered
            },
        // {                      // WARNING: Don't mix Piezo Style lickports with MPR121 boards
        //                        // Here is an exmaple of setting up the piezo style lickport 
        //   "type": "piezoport",
        //   "pin": 0,            // Analog pin A0
        //   "lick_duration": 10,
        //   "lick_threshold": 5
        // },
            {
                "type": "rfid_reader", // rfid tag reader for ID-12LA reader
                "pin": 22 // pin is the reset pin on the ID-12LA breakout
            }
        ],
        // "contexts" are time/space localized events that can be configure to
        // occur along the track. See Context Manager in the behavior arduino
        // code for more information
        "contexts": [
            // reward zones are an example of a context and can be configured
            // in this list as well.
            {
                "class": "alternating_context",
                "id": "large_reward", // every context is required to have a
                                      // unique id
                "n_lap": 3, // for class alternating_context, activate this
                            // context only every nth lap. Defaults to 2
                "offset_lap": 1,
                "type": "operant", // specialized contexts are defined
                                   // through the type field. operant type
                                   // contexts are triggered via sensors i.e.
                                   // the lickport
                "max_duration": 5, // maximum time (in s) the context is allowed
                                   // to be active
                "radius": 120, // radius (in mm) of reward zones
                "valves": [7], // list of arduino pints to activate when the
                               // context starts
                "durations": [60], // list of times to open valves for
                "operant_rate": 2,
                "initial_open": 0,
                "sensor": 2, // pin number associated with the sensor to trigger
                             // operant context.
                "locations": [2500, 4500], // integer or list. list - list of
                                           // locations to place context
                                           // centroids. integer - number of
                                           // locations to randomly shuffle
                                           // context to. absent - context is
                                           // active during entire trial
                "display_color": [0,104,204] // color to make display indicating
                                           // the location of this context
            },
            {
                "class": "vr",
                "id": "vivid_stamp", // for vr_contexts the name matches the
                                     // scene name in Unity program
                "display_controllers": { // display controller for virtual reality
                    "window": {
                        "port": 8025,
                        "ip": "127.0.0.1",
                        "view_angle": 40,
                        "deflection": 0
                    }
                },
                "cues": [
                    {
                        "type": "Arch",
                        "z": [400, 1000, 2560, 5000],
                    },
                    {
                        "type": "Cube",
                        "z": [3450, 4560],
                        "x": [30,    -30]
                    },
                    {
                        "type": "Tree",
                        "z": [150, 250, 350, 500, 750, 1150, 1500, 2120, 3000,
                                3325, 3500, 3900, 4200, 4400, 5000, 5200],
                        "x": [-80, -70,  80, -80,  70,   80,  -80,   80,   70,
                                  70,  -70,  -80,  -80,   80,  -70,   80]
                    },
                    {
                        "type": "Toadstools",
                        "z": [175, 2150, 3690, 4000],
                        "x": [25,   -25,  -25,   25]
                    },
                    {
                        "type": "Rock",
                        "z": [550, 1450, 1690, 2300],
                        "x": [ 35,   27,  -35,  -30]
                    },
                    {
                        "type": "Rock2",
                        "z": [2450, 4200, 5500],
                        "x": [ 40,   -40,   40],
                    },
                ]
            },
            {
                "id": "light_context",
                "type": "pulsed", // pulsed contexts open valves for their
                                  // indicated durations at the interval
                                  // specified
                "valves": [7],
                "durations": [500],
                "interval": 1000
            },
            {
                "id": "odor_context",
                "type": "constant",
                "valves": [3],
                "durations": [-1]  // -1 duration means this valve is open the
                                   // whole time
            },
            {
                "id": "tone_context",
                "type": "pulsed",
                "valves": [17],
                "durations": [500],
                "interval": 1000,
                "frequency": 262 // contexts with a frequency set up valves to
                                 // play a tone.
            }
        ],
        "trial_startup": [
            {
                "ip": "127.0.0.1",
                "port": 7010,
                "message": {
                    "action": "start"
                }
            }
        ],
        "trial_shutdown": [
            {
                "ip": "127.0.0.1",
                "port": 7010,
                "message": {
                    "action": "stop"
                }
            }
        ],
        "sync_pin": 12, // a ttl pulse is delivered at the beginning of each
                        // trial to the sync pin.
        "trial_length": 300, // duration (in s) of the trial.
        "position_scale": 1.0, // scales the position updates from aritrary
                               // unitst to mm. IMPORTANT! measure this value
                               // on each rig or position updates will be wrong
        "track_length": 6000, // length of the track/treadmill belt.
        "lap_reset_tag": "", // if not an empty string, to hex code from the
                             // rfid tag signaling lap resets
        "lap_tolerance": 0.05 // compensates for missed lap resets tags. i.e.
                              // if 5, the lap will be resarted at 5% of the
                              // belt length if the position reads
                              // 1.05*track_length
    },
    "piezo_example": {
        "uses": "example",
        "sensors": [
            {                      // WARNING: Don't mix Piezo Style lickports with MPR121 boards
                                   // Here is an exmaple of setting up the piezo style lickport 
                "type": "piezoport",
                "pin": 0,            // Analog pin A0
                "lick_duration": 10,
                "lick_threshold": 5
            },
            {
                "type": "rfid_reader", // rfid tag reader for ID-12LA reader
                "pin": 22 // pin is the reset pin on the ID-12LA breakout
            }
        ],
    },
    "salience_example": { // name for each profile of in this setting file
        "uses": "example",
        "reward": null,
        // "contexts" are time/space localized events that can be configure to
        // occur along the track. See Context Manager in the behavior arduino
        // code for more information
        "contexts": [
            // reward zones are an example of a context and can be configured
            // in this list as well.
            {
                "class": "salience",
                "id": "salience context",
                "num_blocks": 2,
                "sync_pin": 12,
                "trial_length": 9,
                "prestim_time": 3,
                "poststim_time": 2,
                "stim_time": 5,
                "stims": [
                    {
                        "name": "light",
                        "address": "behavior_controller",
                        "pin": 5,
                        "duration": 100
                    },
                    {
                        "name": "airpuff",
                        "address": "behavior_controller",
                        "pin": 7,
                        "duration": 100
                    },
                    {
                        "name": "tone",
                        "pin": 15,
                        "address": "behavior_controller",
                        "duration": 500,
                        "frequency": 500
                    }
                ]
            },
        ],
        "trial_length": -1, // duration (in s) of the trial. -1 allows the
                            // trial to run until stopped by the user or 
                            // SalienceContext
    },
    "attributes_example": {
        "uses": "example",
        // trial attrs allow for a custom form to overwrite settings or add
        // attitional attributes to the settings field in the .tdml file.
        // Remove this field to stop the form from popping up. Trials will
        // not be allowed to start without completed attribute forms.
        "trial_attrs": {
            "fields": [
                {
                    "key": "trial_length", // if this key matches a field in the
                                           // settings.json file, the value will
                                           // be replaced by the entry each
                                           // trial.
                    "type": "int"
                },
                {
                    "key": "drugCondition",
                    "type": "JSONArray",
                    "fields": [
                        {
                            "key": "drug",
                            "type": "JSONObject",
                            "fields": [
                                {
                                    "key": "time1",
                                    "type": "int"
                                },
                                {
                                    "key": "time2",
                                    "type": "int"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    // the _system holde the data directory field. this does not get saved each
    // trial and needs to be set to a directory where the program can write
    // and store files. if windows, ensure to escape backslashes i.e. \\
    "_system": {
        "data_directory":"C:\\Users\\admin\\Desktop\\behaviorData",
        "arduino_controller": "..\\arduino_controller\\arduinoController.exe"
    }
}
